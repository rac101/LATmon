#!/usr/local/bin/perl -w

# get Fermi LAT on-board SAA polygon vertex coordinates, and check against archive
# do this weekly, by cron, to check if FOT is ~monthly doing an update

# here is the format of the MnemRet.py command:
# MnemRet.py -b '-1 hour' -e '2017-04-19 00:00:00' --expr 'VSGSAA[12]PLONG[01][0-9]' --expr 'VSGSAA[12]PLAT[01][0-9]' --csv /dev/stdout

# which produces the output:
#TIME,TSTAMP,VSGSAA1PLONG11,VSGSAA1PLONG10,VSGSAA1PLONG12,VSGSAA2PLONG06,VSGSAA2PLONG02,VSGSAA2PLONG07,VSGSAA2PLONG05,VSGSAA2PLONG04,VSGSAA2PLONG03,VSGSAA2PLONG0
#1,VSGSAA2PLONG08,VSGSAA1PLONG06,VSGSAA1PLONG05,VSGSAA1PLONG02,VSGSAA1PLONG08,VSGSAA1PLONG07,VSGSAA1PLONG04,VSGSAA1PLONG03,VSGSAA1PLONG09,VSGSAA2PLONG09,VSGSAA1P
#LONG01,VSGSAA2PLONG11,VSGSAA2PLONG10,VSGSAA2PLONG12,VSGSAA2PLAT06,VSGSAA2PLAT05,VSGSAA2PLAT04,VSGSAA2PLAT02,VSGSAA2PLAT01,VSGSAA2PLAT09,VSGSAA2PLAT08,VSGSAA1PLA
#T04,VSGSAA1PLAT05,VSGSAA1PLAT06,VSGSAA1PLAT07,VSGSAA1PLAT01,VSGSAA1PLAT02,VSGSAA1PLAT03,VSGSAA2PLAT10,VSGSAA2PLAT12,VSGSAA2PLAT07,VSGSAA2PLAT11,VSGSAA1PLAT12,VS
#GSAA1PLAT10,VSGSAA1PLAT09,VSGSAA1PLAT11,VSGSAA1PLAT08,VSGSAA2PLAT03
#"2017-04-18 23:42:34.540077",1492558954.540077,-92.3576278687,-98.7405853271,-86.3746795654,-45.2173576355,12.1856813431,-65.2212219238,-38.6176452637,-30.82437
#51526,-9.32531452179,33.7110290527,-84.229927063,-42.2145690918,-36.2145996094,24.2967681885,-93.3340835571,-59.0187149048,-25.9159297943,-18.8183670044,-97.736
#1755371,-89.4345932007,33.7110290527,-94.5513381958,-94.5437850952,-86.3746795654,1.93263316154,1.92530739307,0.317937582731,-19.9602642059,-30.0793151855,-8.88
#113689423,-6.16478681564,5.11406803131,5.12288284302,4.52918481827,0.650709033012,-30.0793151855,-22.6869277954,2.40959143639,-14.2126407623,-30.0062637329,-1.0
#4017281532,-18.3966350555,-30.0062637329,-12.4856929779,-9.8873462677,-21.6962871552,-8.59464359283,-9.82722091675

# input from STDIN

# output to STDOUT = ARCHIVE will be
# YYYY MM DD DOY HH MM SS.ssssss unix-time MET polygon LAT and LONG values in alphabetical order of mnemonic

# Robert Cameron
# May 2017

# usage: ./catchup-xpoly.pl < w2 >> history.poly

$cmd1 = "MnemRet.py -b '-20 minutes' -e '";
$cmd2 = "' --expr 'VSGSAA[12]PLONG[01][0-9]' --expr 'VSGSAA[12]PLAT[01][0-9]' --csv /dev/stdout | xpoly.pl";

# read in week date list, and run the constructed command for each week
while (<>) {
    chomp;
    $cmd = $cmd1.$_.$cmd2;
    print "$cmd\n";
#    $out = `$cmd`;
#    print $out;
}
